module.exports=function(e){var t={};function r(s){if(t[s])return t[s].exports;var l=t[s]={i:s,l:!1,exports:{}};return e[s].call(l.exports,l,l.exports,r),l.l=!0,l.exports}return r.m=e,r.c=t,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:s})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";e.exports=r(1)},function(e,t,r){"use strict";const s=r(2),{format:l,inspect:o}=r(3),i=r(4),n={showHidden:!1,depth:20,colors:!1,customInspect:!0,showProxy:!1,maxArrayLength:1/0,breakLength:60};class a{constructor(e){this.level=a.levels.NONE,this.colors=a.HAS_TTY,this.console=!0,this.shrink=!0,this.closed=!0,this.closing=!1,this.filename=null,this.stream=null,this.contexts=Object.create(null),e&&this.set(e)}set(e){s(e),s(this.closed),"string"!=typeof e?(null!=e.level&&(s("string"==typeof e.level),this.setLevel(e.level)),null!=e.colors&&a.HAS_TTY&&(s("boolean"==typeof e.colors),this.colors=e.colors),null!=e.console&&(s("boolean"==typeof e.console),this.console=e.console),null!=e.shrink&&(s("boolean"==typeof e.shrink),this.shrink=e.shrink),null!=e.filename&&(s("string"==typeof e.filename,"Bad file."),this.filename=e.filename)):this.setLevel(e)}async open(){this.filename?this.stream?this.closed=!1:i.unsupported?this.closed=!1:(this.shrink&&await this.truncate(),this.stream=await u(this.filename),this.stream.once("error",this.handleError.bind(this)),this.closed=!1):this.closed=!1}async close(){if(null!=this.timer&&(clearTimeout(this.timer),this.timer=null),i.unsupported)return this.closed=!0,void(this.stream=null);if(this.stream){try{this.closing=!0,await(e=this.stream,new Promise((t,r)=>{const s=()=>{e.removeListener("error",l),e.removeListener("close",o)},l=e=>{s(),r(e)},o=()=>{s(),t(e)};e.removeAllListeners("error"),e.removeAllListeners("close"),e.once("error",l),e.once("close",o),e.close()}))}finally{this.closing=!1}this.stream=null}var e;this.closed=!0}async truncate(){if(!this.filename)return;if(i.unsupported)return;let e;s(!this.stream);try{e=await i.stat(this.filename)}catch(e){if("ENOENT"===e.code)return;throw e}const t=a.MAX_FILE_SIZE;if(e.size<=t+t/10)return;this.debug("Truncating log file to %dmb.",h(t));const r=await i.open(this.filename,"r+"),l=Buffer.allocUnsafe(t);await i.read(r,l,0,t,e.size-t),await i.ftruncate(r,t),await i.write(r,l,0,t,0),await i.close(r)}handleError(e){try{this.stream.close()}catch(e){}this.stream=null,this.retry()}async reopen(){if(!this.stream&&!this.closed&&!i.unsupported){try{this.stream=await u(this.filename)}catch(e){return void this.retry()}this.stream.once("error",e=>this.handleError(e))}}retry(){null==this.timer&&(this.timer=setTimeout(()=>{this.timer=null,this.reopen()},1e4))}setFile(e){s("string"==typeof e),s(!this.stream,"Log stream has already been created."),this.filename=e}setLevel(e){const t=a.levels[e.toUpperCase()];s(null!=t,"Invalid log level."),this.level=t}fmt(e,t){if(e.length>0){const[r]=e;if(r&&"object"==typeof r)return n.colors=t,o(r,n)}return l(...e)}error(...e){if(this.level<a.levels.ERROR)return;const t=e[0];t instanceof Error?this.logError(a.levels.ERROR,null,t):this.log(a.levels.ERROR,null,e)}warning(...e){if(this.level<a.levels.WARNING)return;const t=e[0];t instanceof Error?this.logError(a.levels.WARNING,null,t):this.log(a.levels.WARNING,null,e)}info(...e){if(this.level<a.levels.INFO)return;const t=e[0];t instanceof Error?this.logError(a.levels.INFO,null,t):this.log(a.levels.INFO,null,e)}debug(...e){if(this.level<a.levels.DEBUG)return;const t=e[0];t instanceof Error?this.logError(a.levels.DEBUG,null,t):this.log(a.levels.DEBUG,null,e)}spam(...e){if(this.level<a.levels.SPAM)return;const t=e[0];t instanceof Error?this.logError(a.levels.SPAM,null,t):this.log(a.levels.SPAM,null,e)}log(e,t,r){this.closed||this.level<e||(this.writeConsole(e,t,r),this.writeStream(e,t,r))}context(e){let t=this.contexts[e];return t||(t=new c(this,e),this.contexts[e]=t),t}writeConsole(e,t,r){const l=a.levelsByVal[e];if(s(l,"Invalid log level."),!this.console)return!1;if(!process.stdout){let s=`[${l}] `;if(t&&(s+=`(${t}) `),r.length>0){const[t]=r;if(t&&"object"==typeof t)return e===a.levels.ERROR?console.error(s,t):console.log(s,t)}return s+=this.fmt(r,!1),e===a.levels.ERROR?console.error(s):console.log(s),!0}let o;if(this.colors){const t=a.styles[e];s(t),o=`[${t}m[${l}][m `}else o=`[${l}] `;return t&&(o+=`(${t}) `),o+=this.fmt(r,this.colors),o+="\n",e===a.levels.ERROR?process.stderr.write(o):process.stdout.write(o)}writeStream(e,t,r){const l=a.prefixByVal[e];if(s(l,"Invalid log level."),!this.stream)return;if(this.closing)return;let o=`[${l}:${(new Date).toISOString().slice(0,-5)+"Z"}] `;t&&(o+=`(${t}) `),o+=this.fmt(r,!1),o+="\n",this.stream.write(o)}logError(e,t,r){if(this.closed)return;i.unsupported&&this.console&&e<=a.levels.WARNING&&console.error(r);let s=String(r.message).replace(/^ *Error: */,"");e!==a.levels.ERROR&&(s=`Error: ${s}`),this.log(e,t,[s]),e<=a.levels.WARNING&&this.stream&&this.stream.write(r.stack+"\n")}memoryUsage(){if(!process.memoryUsage)return{total:0,jsHeap:0,jsHeapTotal:0,nativeHeap:0,external:0};const e=process.memoryUsage();return{total:h(e.rss),jsHeap:h(e.heapUsed),jsHeapTotal:h(e.heapTotal),nativeHeap:h(e.rss-e.heapTotal),external:h(e.external)}}memory(e){const t=this.memoryUsage();this.log(a.levels.DEBUG,e,["Memory: rss=%dmb, js-heap=%d/%dmb native-heap=%dmb",t.total,t.jsHeap,t.jsHeapTotal,t.nativeHeap])}}class c{constructor(e,t){s("string"==typeof t),this.logger=e,this.module=t}open(){return this.logger.open()}close(){return this.logger.close()}setFile(e){this.logger.setFile(e)}setLevel(e){this.logger.setLevel(e)}error(...e){if(this.logger.level<a.levels.ERROR)return;const t=e[0];t instanceof Error?this.logError(a.levels.ERROR,t):this.log(a.levels.ERROR,e)}warning(...e){if(this.logger.level<a.levels.WARNING)return;const t=e[0];t instanceof Error?this.logError(a.levels.WARNING,t):this.log(a.levels.WARNING,e)}info(...e){if(this.logger.level<a.levels.INFO)return;const t=e[0];t instanceof Error?this.logError(a.levels.INFO,t):this.log(a.levels.INFO,e)}debug(...e){if(this.logger.level<a.levels.DEBUG)return;const t=e[0];t instanceof Error?this.logError(a.levels.DEBUG,t):this.log(a.levels.DEBUG,e)}spam(...e){if(this.logger.level<a.levels.SPAM)return;const t=e[0];t instanceof Error?this.logError(a.levels.SPAM,t):this.log(a.levels.SPAM,e)}log(e,t){this.logger.log(e,this.module,t)}context(e){return new c(this.logger,e)}logError(e,t){this.logger.logError(e,this.module,t)}memoryUsage(){return this.logger.memoryUsage()}memory(){this.logger.memory(this.module)}}function h(e){return Math.floor(e/(1<<20))}function u(e){return new Promise((t,r)=>{const s=i.createWriteStream(e,{flags:"a"}),l=()=>{s.removeListener("error",o),s.removeListener("open",n)},o=e=>{try{s.close()}catch(e){}l(),r(e)},n=()=>{l(),t(s)};s.once("error",o),s.once("open",n)})}a.HAS_TTY=Boolean(process.stdout&&process.stdout.isTTY),a.MAX_FILE_SIZE=20<<20,a.levels={NONE:0,ERROR:1,WARNING:2,INFO:3,DEBUG:4,SPAM:5},a.levelsByVal=["none","error","warning","info","debug","spam"],a.prefixByVal=["N","E","W","I","D","S"],a.styles=["0","1;31","1;33","94","90","90"],a.global=new a,e.exports=a},function(e,t){e.exports=require("assert")},function(e,t){e.exports=require("util")},function(e,t,r){"use strict";const s=r(5);function l(e){return function(...t){return new Promise((r,s)=>{t.push((r=r,s=s,function(e,t){e?s(e):r(t)})),e.call(this,...t)});var r,s}}t.stat=l(s.stat),t.open=l(s.open),t.close=l(s.close),t.read=l(s.read),t.write=l(s.write),t.ftruncate=l(s.ftruncate),t.createWriteStream=s.createWriteStream},function(e,t){e.exports=require("fs")}]);